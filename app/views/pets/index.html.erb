<div class="small-jumbotron text-center ">
</div>

<div class="container">
  <!-- Search bar disabled for now, need to implement post-MVP -->
  <form class="form-inline form-inline-search">
    <div class="form-group col-sm-10 col-xs-10">
      <input class="form-control" id="anythingSearch" type="text" placeholder="Rechercher par tags">
    </div>
    <div class="form-group">
      <div id="searchBtn" class="my-3">
        <button class="btn btn-outline-primary btn-main-page">Rechercher</button>
      </div>
    </div>
  </form>
  <hr>
  <a tabindex="0" class="btn btn-sm btn-outline-primary btn-info-match" role="button" data-toggle="popover" data-trigger="focus" title="C'est quoi un match ?" data-content="Rien n'est plus simple : si un animal vous plaît, cliquez sur le cœur sur son profil. Lorsque cet animal like aussi votre profil, c'est un Match !"> Match ? </a>
</div>

<div class="container justify-content-around">
<div class="row justify-content-around ml-3 mr-3">

    <% @pets_list.each do |pet| %>

      <div class="col-sm-3">
        <% if Like.where(liker_id: @current_pet.id, liked_id: pet.id, match: true).exists? || Like.where(liked_id: @current_pet.id, liker_id: pet.id, match: true).exists? %>
        <div id="likeCard<%= pet.id %>" class="card scale-down bg-custom text-white mb-3">
        <% else %>
          <div id="likeCard<%= pet.id %>" class="card bg-light mb-3">
            <div id="likeHeader<%= pet.id %>" class="card-header">
              <h5 class="card-title float-left"><%= pet.name%></h5>
                <% pet.tags.each do |tag|%>
                  <span class='badge badge-secondary mr-2 mb-1 float-right'><%=tag.value%></span>
                <%end%>
            </div>
            <div id="likeBody<%= pet.id %>" class="card-body">
              <div id="demo" class="carousel slide" data-ride="carousel" data-interval="7000">
                <div class="carousel-inner" >
                  <% unless pet.photos.empty? %>
                    <div class="carousel-item active">
                      <%= image_tag pet.photos.first, class: "card-img-top" %>
                    </div>
                    <% pet.photos[1..-1].each do |p| %>
                      <div class="carousel-item">
                        <%= image_tag p, class: "card-img-top" %>
                      </div>
                    <% end %>
                  <% else %>
                    <div class="carousel-item active">
                      <%= image_tag("paw.svg", {class: "card-img-top"} ) %>
                    </div>
                    <div class="carousel-item">
                      <%= image_tag("paw.svg", {class: "card-img-top"} ) %>
                    </div>

                      <!---------------------CARD BODY END--------------------->



                <div class="mt-3"><h6 class="card-subtitle mt-2 float-left"><%= pet.age.to_i %>, <%= pet.sex %></h6><span>
                  <% if pet.likes_as_liked.where(liker_id: @current_pet.id, match: false).exists? %>
                  <i id="likeButton<%= pet.id %>" class="btn btn-primary btn-sm fa fa-heart float-right"></i>
                  <% elsif pet.likes_as_liker.where(liked_id: @current_pet.id).exists? %>
                  <% like = Like.all.where(liker_id: pet.id, liked_id: @current_pet.id) %>
                  <%= link_to pet_like_path(pet.id,like.ids), method: :put, remote: true do %><i id="likeButton<%= pet.id %>" class="btn btn-outline-primary btn-sm fa fa-heart float-right"></i><% end %>
                  <% else %>
                  <%= link_to pet_likes_path(pet.id), method: :post, remote: true do %><i id="likeButton<%= pet.id %>" class="btn btn-outline-primary btn-sm fa fa-heart float-right"></i><% end %>
                  <% end %>
                </div>
              </div>
          <!---------------------CARD BODY END--------------------->
              <div class="mt-3">
                <% if pet.short_description != nil %>
                  <h6 class="card-subtitle my-3 text-primary"><em>"<%= pet.short_description%>"</em></h6>
                <% end %>
                <h6 class="card-subtitle mt-2 float-left"><%= pet.age.to_i %>, <%= pet.sex %></h6><span>
                <%= link_to pet_likes_path(pet.id), method: :post, remote: true do %>
                  <i id="likeButton<%= pet.id %>" class="btn btn-outline-primary btn-sm fa fa-heart float-right"></i>
                <% end %>
              </div>
            </div>
          </div>
      </div>

  </div>
<% end %>
  </div>
</div>
